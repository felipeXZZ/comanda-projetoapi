{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterLink } from '@angular/router';\nimport { TopbarComponent } from '../../admin-area/topbarAdmin/topbarAdmin.component';\nlet AdminDashboardComponent = class AdminDashboardComponent {\n  pedidoService;\n  dishService;\n  // Seção de Pedidos\n  pedidos = [];\n  isLoadingPedidos = true;\n  errorPedidos = null;\n  statusList = ['RECEBIDO', 'EM_PREPARO', 'SAIU_PARA_ENTREGA', 'ENTREGUE', 'CANCELADO'];\n  // 2. NOVA SEÇÃO DE PRATOS\n  dishes = [];\n  isLoadingDishes = true;\n  errorDishes = null;\n  // 3. INJETA OS DOIS SERVIÇOS\n  constructor(pedidoService, dishService // <-- INJETA O DISH SERVICE\n  ) {\n    this.pedidoService = pedidoService;\n    this.dishService = dishService;\n  }\n  ngOnInit() {\n    // 4. CARREGA AS DUAS LISTAS\n    this.loadPedidos();\n    this.loadDishes();\n  }\n  loadPedidos() {\n    this.isLoadingPedidos = true;\n    this.errorPedidos = null;\n    this.pedidoService.getAllPedidos().subscribe({\n      next: data => {\n        this.pedidos = data.sort((a, b) => b.id - a.id);\n        this.isLoadingPedidos = false;\n      },\n      error: err => {\n        this.errorPedidos = 'Não foi possível carregar os pedidos.';\n        this.isLoadingPedidos = false;\n      }\n    });\n  }\n  // 5. NOVA LÓGICA PARA CARREGAR PRATOS\n  loadDishes() {\n    this.isLoadingDishes = true;\n    this.errorDishes = null;\n    this.dishService.getDishes().subscribe({\n      next: data => {\n        this.dishes = data.sort((a, b) => (a.id || 0) - (b.id || 0));\n        this.isLoadingDishes = false;\n      },\n      error: err => {\n        this.errorDishes = 'Não foi possível carregar os pratos.';\n        this.isLoadingDishes = false;\n      }\n    });\n  }\n  // 6. NOVA LÓGICA PARA DELETAR PRATOS\n  deleteDish(id) {\n    if (!id) return;\n    if (confirm('Tem certeza que deseja deletar este prato?')) {\n      this.dishService.deleteDish(id).subscribe({\n        next: () => {\n          this.dishes = this.dishes.filter(dish => dish.id !== id);\n        },\n        error: err => {\n          alert('Erro ao deletar o prato.');\n        }\n      });\n    }\n  }\n  // (Lógica de onStatusChange continua a mesma)\n  onStatusChange(pedidoId, event) {\n    const selectElement = event.target;\n    const novoStatus = selectElement.value;\n    if (!novoStatus) return;\n    this.pedidoService.updatePedidoStatus(pedidoId, novoStatus).subscribe({\n      next: pedidoAtualizado => {\n        const index = this.pedidos.findIndex(p => p.id === pedidoId);\n        if (index !== -1) {\n          this.pedidos[index].status = pedidoAtualizado.status;\n        }\n      },\n      error: err => {\n        alert('Erro ao atualizar status. (O bug do @Transactional ainda pode estar aqui se o Eclipse não reiniciou corretamente!)');\n      }\n    });\n  }\n};\nAdminDashboardComponent = __decorate([Component({\n  selector: 'app-admin-dashboard',\n  standalone: true,\n  imports: [CommonModule, RouterLink, TopbarComponent],\n  templateUrl: './admin-area/admin-dashboard.component.html',\n  styleUrls: ['../admin-area/admin-dashboard.component.css']\n})], AdminDashboardComponent);\nexport { AdminDashboardComponent };","map":{"version":3,"names":["Component","CommonModule","RouterLink","TopbarComponent","AdminDashboardComponent","pedidoService","dishService","pedidos","isLoadingPedidos","errorPedidos","statusList","dishes","isLoadingDishes","errorDishes","constructor","ngOnInit","loadPedidos","loadDishes","getAllPedidos","subscribe","next","data","sort","a","b","id","error","err","getDishes","deleteDish","confirm","filter","dish","alert","onStatusChange","pedidoId","event","selectElement","target","novoStatus","value","updatePedidoStatus","pedidoAtualizado","index","findIndex","p","status","__decorate","selector","standalone","imports","templateUrl","styleUrls"],"sources":["C:\\Users\\jvgam\\OneDrive\\Área de Trabalho\\ComandaProjeto\\dish-app\\dish-app\\src\\app\\components\\admin-area\\admin-dashboard\\admin-dashboard.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { RouterLink } from '@angular/router';\r\nimport { TopbarComponent } from '../../admin-area/topbarAdmin/topbarAdmin.component';\r\n\r\n// 1. IMPORTA OS DOIS SERVIÇOS\r\nimport { PedidoService, PedidoCompleto } from '../../../services/pedido.service';\r\nimport { Dish, DishService } from '../../../services/dish.service'; // <-- IMPORTA O DISH SERVICE\r\n\r\n@Component({\r\n  selector: 'app-admin-dashboard',\r\n  standalone: true,\r\n  imports: [CommonModule, RouterLink, TopbarComponent],\r\n  templateUrl: './admin-area/admin-dashboard.component.html',\r\n  styleUrls: ['../admin-area/admin-dashboard.component.css']\r\n})\r\nexport class AdminDashboardComponent implements OnInit {\r\n\r\n  // Seção de Pedidos\r\n  pedidos: PedidoCompleto[] = [];\r\n  isLoadingPedidos = true;\r\n  errorPedidos: string | null = null;\r\n  statusList: string[] = [\r\n    'RECEBIDO', 'EM_PREPARO', 'SAIU_PARA_ENTREGA', 'ENTREGUE', 'CANCELADO'\r\n  ];\r\n\r\n  // 2. NOVA SEÇÃO DE PRATOS\r\n  dishes: Dish[] = [];\r\n  isLoadingDishes = true;\r\n  errorDishes: string | null = null;\r\n\r\n  // 3. INJETA OS DOIS SERVIÇOS\r\n  constructor(\r\n    private pedidoService: PedidoService,\r\n    private dishService: DishService // <-- INJETA O DISH SERVICE\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    // 4. CARREGA AS DUAS LISTAS\r\n    this.loadPedidos();\r\n    this.loadDishes();\r\n  }\r\n\r\n  loadPedidos(): void {\r\n    this.isLoadingPedidos = true;\r\n    this.errorPedidos = null;\r\n    this.pedidoService.getAllPedidos().subscribe({\r\n      next: (data) => {\r\n        this.pedidos = data.sort((a, b) => b.id - a.id);\r\n        this.isLoadingPedidos = false;\r\n      },\r\n      error: (err) => {\r\n        this.errorPedidos = 'Não foi possível carregar os pedidos.';\r\n        this.isLoadingPedidos = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  // 5. NOVA LÓGICA PARA CARREGAR PRATOS\r\n  loadDishes(): void {\r\n    this.isLoadingDishes = true;\r\n    this.errorDishes = null;\r\n    this.dishService.getDishes().subscribe({\r\n      next: (data) => {\r\n        this.dishes = data.sort((a, b) => (a.id || 0) - (b.id || 0));\r\n        this.isLoadingDishes = false;\r\n      },\r\n      error: (err) => {\r\n        this.errorDishes = 'Não foi possível carregar os pratos.';\r\n        this.isLoadingDishes = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  // 6. NOVA LÓGICA PARA DELETAR PRATOS\r\n  deleteDish(id: number | undefined): void {\r\n    if (!id) return;\r\n    if (confirm('Tem certeza que deseja deletar este prato?')) {\r\n      this.dishService.deleteDish(id).subscribe({\r\n        next: () => {\r\n          this.dishes = this.dishes.filter(dish => dish.id !== id);\r\n        },\r\n        error: (err) => {\r\n          alert('Erro ao deletar o prato.');\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  // (Lógica de onStatusChange continua a mesma)\r\n  onStatusChange(pedidoId: number, event: Event): void {\r\n    const selectElement = event.target as HTMLSelectElement;\r\n    const novoStatus = selectElement.value;\r\n    if (!novoStatus) return;\r\n\r\n    this.pedidoService.updatePedidoStatus(pedidoId, novoStatus).subscribe({\r\n      next: (pedidoAtualizado) => {\r\n        const index = this.pedidos.findIndex(p => p.id === pedidoId);\r\n        if (index !== -1) {\r\n          this.pedidos[index].status = pedidoAtualizado.status;\r\n        }\r\n      },\r\n      error: (err) => {\r\n        alert('Erro ao atualizar status. (O bug do @Transactional ainda pode estar aqui se o Eclipse não reiniciou corretamente!)');\r\n      }\r\n    });\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}