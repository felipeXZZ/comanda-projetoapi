{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Gabriel Reis/Desktop/dish-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Validators } from '@angular/forms';\nlet CheckoutComponent = class CheckoutComponent {\n  cart;\n  fb;\n  // liga diretamente ao CartService\n  items$ = this.cart.items$;\n  total$ = this.cart.total$;\n  customerForm;\n  isLoading = false;\n  successMessage = '';\n  error = '';\n  constructor(cart, fb) {\n    this.cart = cart;\n    this.fb = fb;\n    this.customerForm = this.fb.group({\n      nomeCliente: ['', [Validators.required, Validators.minLength(2)]],\n      telefoneCliente: ['', [Validators.required]],\n      enderecoCliente: ['', [Validators.required, Validators.minLength(5)]]\n    });\n  }\n  // trackBy para performance\n  trackByItem(index, item) {\n    return item?.id ?? item?.dish?.id ?? index;\n  }\n  // incrementa usando o prÃ³prio addItem do service\n  increment(item) {\n    this.cart.addItem(item.dish);\n  }\n  // como o service nÃ£o tem \"decrement\", fazemos uma estratÃ©gia simples:\n  // se quantidade > 1, removemos o item e adicionamos (quantidade-1) vezes.\n  // se quantidade == 1, apenas removemos.\n  decrement(item) {\n    if (!item) return;\n    if (item.quantidade <= 1) {\n      this.cart.removeItem(item.dish.id);\n      return;\n    }\n    // ReconstrÃ³i com quantidade-1\n    this.cart.removeItem(item.dish.id);\n    for (let i = 0; i < item.quantidade - 1; i++) {\n      this.cart.addItem(item.dish);\n    }\n  }\n  remove(item) {\n    this.cart.removeItem(item.dish.id);\n  }\n  onSubmit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      _this.error = '';\n      _this.successMessage = '';\n      if (_this.customerForm.invalid) {\n        _this.error = 'Preencha todos os campos corretamente.';\n        return;\n      }\n      const items = _this.cart.getCurrentItems();\n      if (!items.length) {\n        _this.error = 'Seu carrinho estÃ¡ vazio.';\n        return;\n      }\n      try {\n        _this.isLoading = true;\n        // >>> Aqui vocÃª faria a chamada ao backend <<<\n        // await this.http.post('/api/pedidos', { cliente: this.customerForm.value, items }).toPromise();\n        // Simula sucesso\n        yield new Promise(r => setTimeout(r, 600));\n        _this.successMessage = 'Pedido enviado com sucesso! ðŸ‘Œ';\n        _this.cart.clearCart();\n        _this.customerForm.reset();\n      } catch (e) {\n        _this.error = 'NÃ£o foi possÃ­vel enviar o pedido. Tente novamente.';\n      } finally {\n        _this.isLoading = false;\n      }\n    })();\n  }\n};\nCheckoutComponent = __decorate([Component({\n  selector: 'app-checkout',\n  templateUrl: './checkout.component.html'\n})], CheckoutComponent);\nexport { CheckoutComponent };","map":{"version":3,"names":["Component","Validators","CheckoutComponent","cart","fb","items$","total$","customerForm","isLoading","successMessage","error","constructor","group","nomeCliente","required","minLength","telefoneCliente","enderecoCliente","trackByItem","index","item","id","dish","increment","addItem","decrement","quantidade","removeItem","i","remove","onSubmit","_this","_asyncToGenerator","invalid","items","getCurrentItems","length","Promise","r","setTimeout","clearCart","reset","e","__decorate","selector","templateUrl"],"sources":["C:\\Users\\Gabriel Reis\\Desktop\\dish-app\\src\\app\\services\\cart.service.ts"],"sourcesContent":["import { Component } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { Observable } from 'rxjs';\r\nimport { CartService, CartItem } from '../../services/cart.service'; // ajuste o caminho se necessÃ¡rio\r\n\r\n@Component({\r\n  selector: 'app-checkout',\r\n  templateUrl: './checkout.component.html',\r\n})\r\nexport class CheckoutComponent {\r\n  // liga diretamente ao CartService\r\n  items$: Observable<CartItem[]> = this.cart.items$;\r\n  total$: Observable<number> = this.cart.total$;\r\n\r\n  customerForm: FormGroup;\r\n  isLoading = false;\r\n  successMessage = '';\r\n  error = '';\r\n\r\n  constructor(\r\n    public cart: CartService,\r\n    private fb: FormBuilder\r\n  ) {\r\n    this.customerForm = this.fb.group({\r\n      nomeCliente: ['', [Validators.required, Validators.minLength(2)]],\r\n      telefoneCliente: ['', [Validators.required]],\r\n      enderecoCliente: ['', [Validators.required, Validators.minLength(5)]],\r\n    });\r\n  }\r\n\r\n  // trackBy para performance\r\n  trackByItem(index: number, item: CartItem): number | string {\r\n    return (item as any)?.id ?? item?.dish?.id ?? index;\r\n  }\r\n\r\n  // incrementa usando o prÃ³prio addItem do service\r\n  increment(item: CartItem): void {\r\n    this.cart.addItem(item.dish);\r\n  }\r\n\r\n  // como o service nÃ£o tem \"decrement\", fazemos uma estratÃ©gia simples:\r\n  // se quantidade > 1, removemos o item e adicionamos (quantidade-1) vezes.\r\n  // se quantidade == 1, apenas removemos.\r\n  decrement(item: CartItem): void {\r\n    if (!item) return;\r\n    if (item.quantidade <= 1) {\r\n      this.cart.removeItem(item.dish.id);\r\n      return;\r\n    }\r\n    // ReconstrÃ³i com quantidade-1\r\n    this.cart.removeItem(item.dish.id);\r\n    for (let i = 0; i < item.quantidade - 1; i++) {\r\n      this.cart.addItem(item.dish);\r\n    }\r\n  }\r\n\r\n  remove(item: CartItem): void {\r\n    this.cart.removeItem(item.dish.id);\r\n  }\r\n\r\n  async onSubmit(): Promise<void> {\r\n    this.error = '';\r\n    this.successMessage = '';\r\n\r\n    if (this.customerForm.invalid) {\r\n      this.error = 'Preencha todos os campos corretamente.';\r\n      return;\r\n    }\r\n\r\n    const items = this.cart.getCurrentItems();\r\n    if (!items.length) {\r\n      this.error = 'Seu carrinho estÃ¡ vazio.';\r\n      return;\r\n    }\r\n\r\n    try {\r\n      this.isLoading = true;\r\n\r\n      // >>> Aqui vocÃª faria a chamada ao backend <<<\r\n      // await this.http.post('/api/pedidos', { cliente: this.customerForm.value, items }).toPromise();\r\n\r\n      // Simula sucesso\r\n      await new Promise(r => setTimeout(r, 600));\r\n\r\n      this.successMessage = 'Pedido enviado com sucesso! ðŸ‘Œ';\r\n      this.cart.clearCart();\r\n      this.customerForm.reset();\r\n    } catch (e: any) {\r\n      this.error = 'NÃ£o foi possÃ­vel enviar o pedido. Tente novamente.';\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}