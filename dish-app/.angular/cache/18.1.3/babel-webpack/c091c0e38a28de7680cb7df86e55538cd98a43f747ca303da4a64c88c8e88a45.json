{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n// O nome da sua topbar (verifique se 'TopbarComponent' é o seletor correto)\nimport { TopbarComponent } from '../topbarAdmin/topbarAdmin.component';\nlet KitchenOrderComponent = class KitchenOrderComponent {\n  pedidoService;\n  pedidosDaCozinha = [];\n  isLoading = false;\n  error = null;\n  constructor(pedidoService) {\n    this.pedidoService = pedidoService;\n  }\n  ngOnInit() {\n    this.carregarPedidos();\n  }\n  carregarPedidos() {\n    this.isLoading = true;\n    this.error = null;\n    // --- CORREÇÃO 1 ---\n    this.pedidoService.getAllPedidos().subscribe({\n      next: data => {\n        // O FILTRO PRINCIPAL: Pega apenas pedidos \"EM_PREPARO\"\n        this.pedidosDaCozinha = data.filter(pedido => pedido.status === 'EM_PREPARO').sort((a, b) => a.id < b.id ? -1 : 1); // Ordena por ID (mais antigo primeiro)\n        this.isLoading = false;\n      },\n      error: err => {\n        console.error('Erro ao buscar pedidos da cozinha:', err);\n        this.error = 'Não foi possível carregar os pedidos.';\n        this.isLoading = false;\n      }\n    });\n  }\n  /**\n   * Chamado quando o botão \"Marcar como Pronto\" é clicado.\n   */\n  marcarComoPronto(pedido) {\n    if (!pedido.id) return;\n    pedido.isLoading = true;\n    this.pedidoService.updatePedidoStatus(pedido.id, 'PRONTO').subscribe({\n      next: pedidoAtualizado => {\n        // SUCESSO! Removemos ele da lista da cozinha.\n        this.pedidosDaCozinha = this.pedidosDaCozinha.filter(p => p.id !== pedido.id);\n      },\n      error: err => {\n        console.error('Erro ao atualizar status:', err);\n        alert(`Não foi possível atualizar o Pedido #${pedido.id}. Tente novamente.`);\n        pedido.isLoading = false;\n      }\n    });\n  }\n  /**\n   * Função auxiliar para o HTML saber o nome do prato.\n   */\n  // --- CORREÇÃO 2 ---\n  getItensPreview(itens) {\n    if (!itens) return 'Itens não carregados';\n    // Agora 'item.dish.name' vai funcionar\n    return itens.map(item => `${item.quantidade}x ${item.dish.name}`).join(', ');\n  }\n};\nKitchenOrderComponent = __decorate([Component({\n  selector: 'app-kitchen-order',\n  standalone: true,\n  imports: [CommonModule, TopbarComponent],\n  templateUrl: './kitchen-order.component.html',\n  styleUrls: ['./kitchen-order.component.css']\n})], KitchenOrderComponent);\nexport { KitchenOrderComponent };","map":{"version":3,"names":["Component","CommonModule","TopbarComponent","KitchenOrderComponent","pedidoService","pedidosDaCozinha","isLoading","error","constructor","ngOnInit","carregarPedidos","getAllPedidos","subscribe","next","data","filter","pedido","status","sort","a","b","id","err","console","marcarComoPronto","updatePedidoStatus","pedidoAtualizado","p","alert","getItensPreview","itens","map","item","quantidade","dish","name","join","__decorate","selector","standalone","imports","templateUrl","styleUrls"],"sources":["C:\\Users\\jvgam\\OneDrive\\Área de Trabalho\\ComandaProjeto\\dish-app\\dish-app\\src\\app\\components\\admin-area\\kitchen-orders\\kitchen-orders.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n// O nome da sua topbar (verifique se 'TopbarComponent' é o seletor correto)\r\nimport { TopbarComponent } from '../topbarAdmin/topbarAdmin.component';\r\n// Importe ItemPedidoCompleto\r\nimport { PedidoService, PedidoCompleto } from '../../../services/pedido.service'; \r\n\r\n@Component({\r\n  selector: 'app-kitchen-order',\r\n  standalone: true,\r\n  imports: [\r\n    CommonModule,\r\n    TopbarComponent \r\n  ],\r\n  templateUrl: './kitchen-order.component.html',\r\n  styleUrls: ['./kitchen-order.component.css']\r\n})\r\nexport class KitchenOrderComponent implements OnInit {\r\n\r\n  public pedidosDaCozinha: pedidosDaCozinha[] = [];\r\n  public isLoading = false;\r\n  public error: string | null = null;\r\n\r\n  constructor(private pedidoService: PedidoService) { }\r\n\r\n  ngOnInit(): void {\r\n    this.carregarPedidos();\r\n  }\r\n\r\n  carregarPedidos(): void {\r\n    this.isLoading = true;\r\n    this.error = null;\r\n\r\n    // --- CORREÇÃO 1 ---\r\n    this.pedidoService.getAllPedidos().subscribe({\r\n      next: (data) => {\r\n        // O FILTRO PRINCIPAL: Pega apenas pedidos \"EM_PREPARO\"\r\n        this.pedidosDaCozinha = data\r\n          .filter(pedido => pedido.status === 'EM_PREPARO')\r\n          .sort((a, b) => (a.id! < b.id! ? -1 : 1)); // Ordena por ID (mais antigo primeiro)\r\n        \r\n        this.isLoading = false;\r\n      },\r\n      error: (err) => {\r\n        console.error('Erro ao buscar pedidos da cozinha:', err);\r\n        this.error = 'Não foi possível carregar os pedidos.';\r\n        this.isLoading = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Chamado quando o botão \"Marcar como Pronto\" é clicado.\r\n   */\r\n  marcarComoPronto(pedido: PedidoCompleto): void {\r\n    if (!pedido.id) return;\r\n\r\n    pedido.isLoading = true; \r\n\r\n    this.pedidoService.updatePedidoStatus(pedido.id, 'PRONTO').subscribe({\r\n      next: (pedidoAtualizado) => {\r\n        // SUCESSO! Removemos ele da lista da cozinha.\r\n        this.pedidosDaCozinha = this.pedidosDaCozinha.filter(p => p.id !== pedido.id);\r\n      },\r\n      error: (err) => {\r\n        console.error('Erro ao atualizar status:', err);\r\n        alert(`Não foi possível atualizar o Pedido #${pedido.id}. Tente novamente.`);\r\n        pedido.isLoading = false; \r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Função auxiliar para o HTML saber o nome do prato.\r\n   */\r\n  // --- CORREÇÃO 2 ---\r\n  getItensPreview(itens: ItemPedidoCompleto[]): string {\r\n    if (!itens) return 'Itens não carregados';\r\n    // Agora 'item.dish.name' vai funcionar\r\n    return itens.map(item => `${item.quantidade}x ${item.dish.name}`).join(', ');\r\n  }\r\n}"],"mappings":";AAAA,SAASA,SAAS,QAAgB,eAAe;AACjD,SAASC,YAAY,QAAQ,iBAAiB;AAC9C;AACA,SAASC,eAAe,QAAQ,sCAAsC;AAc/D,IAAMC,qBAAqB,GAA3B,MAAMA,qBAAqB;EAMZC,aAAA;EAJbC,gBAAgB,GAAuB,EAAE;EACzCC,SAAS,GAAG,KAAK;EACjBC,KAAK,GAAkB,IAAI;EAElCC,YAAoBJ,aAA4B;IAA5B,KAAAA,aAAa,GAAbA,aAAa;EAAmB;EAEpDK,QAAQA,CAAA;IACN,IAAI,CAACC,eAAe,EAAE;EACxB;EAEAA,eAAeA,CAAA;IACb,IAAI,CAACJ,SAAS,GAAG,IAAI;IACrB,IAAI,CAACC,KAAK,GAAG,IAAI;IAEjB;IACA,IAAI,CAACH,aAAa,CAACO,aAAa,EAAE,CAACC,SAAS,CAAC;MAC3CC,IAAI,EAAGC,IAAI,IAAI;QACb;QACA,IAAI,CAACT,gBAAgB,GAAGS,IAAI,CACzBC,MAAM,CAACC,MAAM,IAAIA,MAAM,CAACC,MAAM,KAAK,YAAY,CAAC,CAChDC,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAMD,CAAC,CAACE,EAAG,GAAGD,CAAC,CAACC,EAAG,GAAG,CAAC,CAAC,GAAG,CAAE,CAAC,CAAC,CAAC;QAE7C,IAAI,CAACf,SAAS,GAAG,KAAK;MACxB,CAAC;MACDC,KAAK,EAAGe,GAAG,IAAI;QACbC,OAAO,CAAChB,KAAK,CAAC,oCAAoC,EAAEe,GAAG,CAAC;QACxD,IAAI,CAACf,KAAK,GAAG,uCAAuC;QACpD,IAAI,CAACD,SAAS,GAAG,KAAK;MACxB;KACD,CAAC;EACJ;EAEA;;;EAGAkB,gBAAgBA,CAACR,MAAsB;IACrC,IAAI,CAACA,MAAM,CAACK,EAAE,EAAE;IAEhBL,MAAM,CAACV,SAAS,GAAG,IAAI;IAEvB,IAAI,CAACF,aAAa,CAACqB,kBAAkB,CAACT,MAAM,CAACK,EAAE,EAAE,QAAQ,CAAC,CAACT,SAAS,CAAC;MACnEC,IAAI,EAAGa,gBAAgB,IAAI;QACzB;QACA,IAAI,CAACrB,gBAAgB,GAAG,IAAI,CAACA,gBAAgB,CAACU,MAAM,CAACY,CAAC,IAAIA,CAAC,CAACN,EAAE,KAAKL,MAAM,CAACK,EAAE,CAAC;MAC/E,CAAC;MACDd,KAAK,EAAGe,GAAG,IAAI;QACbC,OAAO,CAAChB,KAAK,CAAC,2BAA2B,EAAEe,GAAG,CAAC;QAC/CM,KAAK,CAAC,wCAAwCZ,MAAM,CAACK,EAAE,oBAAoB,CAAC;QAC5EL,MAAM,CAACV,SAAS,GAAG,KAAK;MAC1B;KACD,CAAC;EACJ;EAEA;;;EAGA;EACAuB,eAAeA,CAACC,KAA2B;IACzC,IAAI,CAACA,KAAK,EAAE,OAAO,sBAAsB;IACzC;IACA,OAAOA,KAAK,CAACC,GAAG,CAACC,IAAI,IAAI,GAAGA,IAAI,CAACC,UAAU,KAAKD,IAAI,CAACE,IAAI,CAACC,IAAI,EAAE,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC;EAC9E;CACD;AAhEYjC,qBAAqB,GAAAkC,UAAA,EAVjCrC,SAAS,CAAC;EACTsC,QAAQ,EAAE,mBAAmB;EAC7BC,UAAU,EAAE,IAAI;EAChBC,OAAO,EAAE,CACPvC,YAAY,EACZC,eAAe,CAChB;EACDuC,WAAW,EAAE,gCAAgC;EAC7CC,SAAS,EAAE,CAAC,+BAA+B;CAC5C,CAAC,C,EACWvC,qBAAqB,CAgEjC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}