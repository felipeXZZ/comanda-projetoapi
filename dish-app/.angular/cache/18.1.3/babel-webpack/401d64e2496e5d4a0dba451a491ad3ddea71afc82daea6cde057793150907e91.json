{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { RouterLink } from '@angular/router';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/dish.service\";\nimport * as i2 from \"../../services/cart.service\";\nimport * as i3 from \"@angular/common\";\nconst _c0 = a0 => [\"/edit-dish\", a0];\nfunction DishListComponent_tr_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\")(10, \"button\", 2);\n    i0.ɵɵlistener(\"click\", function DishListComponent_tr_14_Template_button_click_10_listener() {\n      const dish_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.deleteDish(dish_r2.id));\n    });\n    i0.ɵɵtext(11, \"Delete\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"a\", 3);\n    i0.ɵɵtext(13, \"Edit\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const dish_r2 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(dish_r2.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(dish_r2.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(dish_r2.description);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(dish_r2.price);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(5, _c0, dish_r2.id));\n  }\n}\nexport let DishListComponent = /*#__PURE__*/(() => {\n  class DishListComponent {\n    dishService;\n    cartService;\n    dishes = [];\n    isLoading = true;\n    error = null;\n    // Observables para o resumo do carrinho\n    totalItensNoCarrinho$;\n    totalPrecoCarrinho$;\n    // 2. INJETA O CART SERVICE (além do DishService)\n    constructor(dishService, cartService // <-- INJETADO AQUI\n    ) {\n      this.dishService = dishService;\n      this.cartService = cartService;\n      // 3. Conecta os Observables do carrinho para o HTML\n      this.totalPrecoCarrinho$ = this.cartService.total$;\n      this.totalItensNoCarrinho$ = this.cartService.items$.pipe(\n      // Calcula o número total de itens (soma das quantidades)\n      map(items => items.reduce((total, item) => total + item.quantidade, 0)));\n    }\n    ngOnInit() {\n      this.loadDishes();\n    }\n    loadDishes() {\n      this.isLoading = true;\n      this.error = null;\n      this.dishService.getDishes().subscribe({\n        next: data => {\n          this.dishes = data;\n          this.isLoading = false;\n          console.log('Pratos carregados:', data);\n        },\n        error: err => {\n          console.error('Erro ao buscar pratos:', err);\n          this.error = 'Não foi possível carregar o cardápio. O backend está rodando?';\n          this.isLoading = false;\n        }\n      });\n    }\n    // 4. NOVO MÉTODO: Chamado quando o cliente clica em \"Adicionar\"\n    adicionarAoCarrinho(dish) {\n      console.log('Adicionando ao carrinho:', dish.name);\n      this.cartService.addItem(dish);\n    }\n    // (O método deleteDish pode ficar, é útil para o admin)\n    deleteDish(id) {\n      if (!id) return;\n      if (confirm('Tem certeza que deseja deletar este prato?')) {\n        this.dishService.deleteDish(id).subscribe({\n          next: () => {\n            console.log('Prato deletado com sucesso');\n            this.dishes = this.dishes.filter(dish => dish.id !== id);\n          },\n          error: err => {\n            this.error = 'Erro ao deletar o prato.';\n          }\n        });\n      }\n    }\n    static ɵfac = function DishListComponent_Factory(ɵt) {\n      return new (ɵt || DishListComponent)(i0.ɵɵdirectiveInject(i1.DishService), i0.ɵɵdirectiveInject(i2.CartService));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: DishListComponent,\n      selectors: [[\"app-dish-list\"]],\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 17,\n      vars: 1,\n      consts: [[4, \"ngFor\", \"ngForOf\"], [\"routerLink\", \"/add-dish\"], [3, \"click\"], [3, \"routerLink\"]],\n      template: function DishListComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"h2\");\n          i0.ɵɵtext(1, \"Dish List\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(2, \"table\")(3, \"tr\")(4, \"th\");\n          i0.ɵɵtext(5, \"ID\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(6, \"th\");\n          i0.ɵɵtext(7, \"Name\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(8, \"th\");\n          i0.ɵɵtext(9, \"Description\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(10, \"th\");\n          i0.ɵɵtext(11, \"Price\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(12, \"th\");\n          i0.ɵɵtext(13, \"Actions\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(14, DishListComponent_tr_14_Template, 14, 7, \"tr\", 0);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(15, \"a\", 1);\n          i0.ɵɵtext(16, \"Add New Dish\");\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(14);\n          i0.ɵɵproperty(\"ngForOf\", ctx.dishes);\n        }\n      },\n      dependencies: [CommonModule, i3.NgForOf, RouterLink],\n      styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n    });\n  }\n  return DishListComponent;\n})();","map":{"version":3,"names":["CommonModule","RouterLink","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","DishListComponent_tr_14_Template_button_click_10_listener","dish_r2","ɵɵrestoreView","_r1","$implicit","ctx_r2","ɵɵnextContext","ɵɵresetView","deleteDish","id","ɵɵadvance","ɵɵtextInterpolate","name","description","price","ɵɵproperty","ɵɵpureFunction1","_c0","DishListComponent","dishService","cartService","dishes","isLoading","error","totalItensNoCarrinho$","totalPrecoCarrinho$","constructor","total$","items$","pipe","map","items","reduce","total","item","quantidade","ngOnInit","loadDishes","getDishes","subscribe","next","data","console","log","err","adicionarAoCarrinho","dish","addItem","confirm","filter","ɵɵdirectiveInject","i1","DishService","i2","CartService","selectors","standalone","features","ɵɵStandaloneFeature","decls","vars","consts","template","DishListComponent_Template","rf","ctx","ɵɵtemplate","DishListComponent_tr_14_Template","i3","NgForOf","styles"],"sources":["C:\\Users\\Gabriel Reis\\Desktop\\dish-app\\src\\app\\components\\dish-list\\dish-list.component.ts","C:\\Users\\Gabriel Reis\\Desktop\\dish-app\\src\\app\\components\\dish-list\\dish-list.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { RouterLink } from '@angular/router';\r\nimport { Observable } from 'rxjs'; // Importa o Observable\r\n\r\n// NOSSOS SERVIÇOS\r\nimport { Dish, DishService } from '../../services/dish.service';\r\nimport { CartService, CartItem } from '../../services/cart.service'; // <-- 1. IMPORTA O CART SERVICE\r\n\r\n@Component({\r\n  selector: 'app-dish-list',\r\n  standalone: true,\r\n  imports: [\r\n    CommonModule,\r\n    RouterLink\r\n  ],\r\n  templateUrl: './dish-list.component.html',\r\n  styleUrls: ['./dish-list.component.css']\r\n})\r\nexport class DishListComponent implements OnInit {\r\n\r\n  dishes: Dish[] = [];\r\n  isLoading = true;\r\n  error: string | null = null;\r\n\r\n  // Observables para o resumo do carrinho\r\n  public totalItensNoCarrinho$: Observable<number>;\r\n  public totalPrecoCarrinho$: Observable<number>;\r\n\r\n  // 2. INJETA O CART SERVICE (além do DishService)\r\n  constructor(\r\n    private dishService: DishService,\r\n    private cartService: CartService // <-- INJETADO AQUI\r\n  ) {\r\n    // 3. Conecta os Observables do carrinho para o HTML\r\n    this.totalPrecoCarrinho$ = this.cartService.total$;\r\n    this.totalItensNoCarrinho$ = this.cartService.items$.pipe(\r\n      // Calcula o número total de itens (soma das quantidades)\r\n      map(items => items.reduce((total, item) => total + item.quantidade, 0))\r\n    );\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.loadDishes();\r\n  }\r\n\r\n  loadDishes(): void {\r\n    this.isLoading = true;\r\n    this.error = null;\r\n    this.dishService.getDishes().subscribe({\r\n      next: (data) => {\r\n        this.dishes = data;\r\n        this.isLoading = false;\r\n        console.log('Pratos carregados:', data);\r\n      },\r\n      error: (err) => {\r\n        console.error('Erro ao buscar pratos:', err);\r\n        this.error = 'Não foi possível carregar o cardápio. O backend está rodando?';\r\n        this.isLoading = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  // 4. NOVO MÉTODO: Chamado quando o cliente clica em \"Adicionar\"\r\n  adicionarAoCarrinho(dish: Dish): void {\r\n    console.log('Adicionando ao carrinho:', dish.name);\r\n    this.cartService.addItem(dish);\r\n  }\r\n\r\n  // (O método deleteDish pode ficar, é útil para o admin)\r\n  deleteDish(id: number | undefined): void {\r\n    if (!id) return;\r\n    if (confirm('Tem certeza que deseja deletar este prato?')) {\r\n      this.dishService.deleteDish(id).subscribe({\r\n        next: () => {\r\n          console.log('Prato deletado com sucesso');\r\n          this.dishes = this.dishes.filter(dish => dish.id !== id);\r\n        },\r\n        error: (err) => {\r\n          this.error = 'Erro ao deletar o prato.';\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\n","<!-- src/app/components/dish-list/dish-list.component.html -->\r\n\r\n<h2>Dish List</h2>\r\n<table>\r\n  <tr>\r\n    <th>ID</th>\r\n    <th>Name</th>\r\n    <th>Description</th>\r\n    <th>Price</th>\r\n    <th>Actions</th>\r\n  </tr>\r\n  <tr *ngFor=\"let dish of dishes\">\r\n    <td>{{ dish.id }}</td>\r\n    <td>{{ dish.name }}</td>\r\n    <td>{{ dish.description }}</td>\r\n    <td>{{ dish.price }}</td>\r\n    <td>\r\n      <button (click)=\"deleteDish(dish.id!)\">Delete</button>\r\n      <a [routerLink]=\"['/edit-dish', dish.id]\">Edit</a>\r\n    </td>\r\n  </tr>\r\n</table>\r\n<a routerLink=\"/add-dish\">Add New Dish</a>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}