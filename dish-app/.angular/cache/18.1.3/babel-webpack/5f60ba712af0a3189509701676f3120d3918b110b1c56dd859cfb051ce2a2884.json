{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n// Importa a Topbar do Admin (ajuste o caminho se for diferente)\nimport { AdminTopbarComponent } from '../admin-topbar/admin-topbar.component';\nlet KitchenOrdersComponent = class KitchenOrdersComponent {\n  pedidoService;\n  pedidosDaCozinha = [];\n  isLoading = false;\n  error = null;\n  constructor(pedidoService) {\n    this.pedidoService = pedidoService;\n  }\n  ngOnInit() {\n    this.carregarPedidos();\n  }\n  carregarPedidos() {\n    this.isLoading = true;\n    this.error = null;\n    // Usa o método 'getTodosPedidos' do seu serviço\n    this.pedidoService.getTodosPedidos().subscribe({\n      next: data => {\n        // FILTRO: Pega apenas pedidos \"EM_PREPARO\"\n        this.pedidosDaCozinha = data.filter(pedido => pedido.status === 'EM_PREPARO').sort((a, b) => a.id < b.id ? -1 : 1); // Ordena por ID (mais antigo primeiro)\n        this.isLoading = false;\n      },\n      error: err => {\n        console.error('Erro ao buscar pedidos da cozinha:', err);\n        this.error = 'Não foi possível carregar os pedidos.';\n        this.isLoading = false;\n      }\n    });\n  }\n  /**\n   * Chamado quando o botão \"Marcar como Pronto\" é clicado.\n   */\n  marcarComoPronto(pedido) {\n    if (!pedido.id) return;\n    // Desabilita o botão (para evitar clique duplo)\n    // Isso usa a propriedade 'isLoading?' que definimos na interface PedidoCompleto\n    pedido.isLoading = true;\n    // Chama o serviço para atualizar o status\n    this.pedidoService.updatePedidoStatus(pedido.id, 'PRONTO').subscribe({\n      next: pedidoAtualizado => {\n        // SUCESSO! O pedido foi atualizado para \"PRONTO\".\n        // Agora, removemos ele da lista da cozinha (feedback visual imediato).\n        this.pedidosDaCozinha = this.pedidosDaCozinha.filter(p => p.id !== pedido.id);\n      },\n      error: err => {\n        console.error('Erro ao atualizar status:', err);\n        // Usamos um 'alert' simples por enquanto\n        alert(`Não foi possível atualizar o Pedido #${pedido.id}. Tente novamente.`);\n        pedido.isLoading = false; // Reabilita o botão em caso de erro\n      }\n    });\n  }\n};\nKitchenOrdersComponent = __decorate([Component({\n  selector: 'app-kitchen-orders',\n  // seletor no plural\n  standalone: true,\n  imports: [CommonModule, AdminTopbarComponent // Adiciona a topbar do admin\n  ],\n  templateUrl: './kitchen-orders.component.html',\n  styleUrls: ['./kitchen-orders.component.css']\n})], KitchenOrdersComponent);\nexport { KitchenOrdersComponent };","map":{"version":3,"names":["Component","CommonModule","AdminTopbarComponent","KitchenOrdersComponent","pedidoService","pedidosDaCozinha","isLoading","error","constructor","ngOnInit","carregarPedidos","getTodosPedidos","subscribe","next","data","filter","pedido","status","sort","a","b","id","err","console","marcarComoPronto","updatePedidoStatus","pedidoAtualizado","p","alert","__decorate","selector","standalone","imports","templateUrl","styleUrls"],"sources":["C:\\Users\\jvgam\\OneDrive\\Área de Trabalho\\ComandaProjeto\\dish-app\\dish-app\\src\\app\\components\\admin-area\\kitchen-orders\\kitchen-orders.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\n// Importa a Topbar do Admin (ajuste o caminho se for diferente)\r\nimport { AdminTopbarComponent } from '../admin-topbar/admin-topbar.component';\r\n\r\n// Importa o serviço e as interfaces corretas\r\nimport { PedidoService, PedidoCompleto, ItemPedidoCompleto } from '../../../services/pedido.service'; \r\n\r\n@Component({\r\n  selector: 'app-kitchen-orders', // seletor no plural\r\n  standalone: true,\r\n  imports: [\r\n    CommonModule,\r\n    AdminTopbarComponent // Adiciona a topbar do admin\r\n  ],\r\n  templateUrl: './kitchen-orders.component.html',\r\n  styleUrls: ['./kitchen-orders.component.css']\r\n})\r\nexport class KitchenOrdersComponent implements OnInit { // classe no plural\r\n\r\n  public pedidosDaCozinha: PedidoCompleto[] = [];\r\n  public isLoading = false;\r\n  public error: string | null = null;\r\n\r\n  constructor(private pedidoService: PedidoService) { }\r\n\r\n  ngOnInit(): void {\r\n    this.carregarPedidos();\r\n  }\r\n\r\n  carregarPedidos(): void {\r\n    this.isLoading = true;\r\n    this.error = null;\r\n\r\n    // Usa o método 'getTodosPedidos' do seu serviço\r\n    this.pedidoService.getTodosPedidos().subscribe({\r\n      next: (data) => {\r\n        // FILTRO: Pega apenas pedidos \"EM_PREPARO\"\r\n        this.pedidosDaCozinha = data\r\n          .filter(pedido => pedido.status === 'EM_PREPARO')\r\n          .sort((a, b) => (a.id! < b.id! ? -1 : 1)); // Ordena por ID (mais antigo primeiro)\r\n        \r\n        this.isLoading = false;\r\n      },\r\n      error: (err) => {\r\n        console.error('Erro ao buscar pedidos da cozinha:', err);\r\n        this.error = 'Não foi possível carregar os pedidos.';\r\n        this.isLoading = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Chamado quando o botão \"Marcar como Pronto\" é clicado.\r\n   */\r\n  marcarComoPronto(pedido: PedidoCompleto): void {\r\n    if (!pedido.id) return;\r\n\r\n    // Desabilita o botão (para evitar clique duplo)\r\n    // Isso usa a propriedade 'isLoading?' que definimos na interface PedidoCompleto\r\n    pedido.isLoading = true; \r\n\r\n    // Chama o serviço para atualizar o status\r\n    this.pedidoService.updatePedidoStatus(pedido.id, 'PRONTO').subscribe({\r\n      next: (pedidoAtualizado) => {\r\n        // SUCESSO! O pedido foi atualizado para \"PRONTO\".\r\n        // Agora, removemos ele da lista da cozinha (feedback visual imediato).\r\n        this.pedidosDaCozinha = this.pedidosDaCozinha.filter(p => p.id !== pedido.id);\r\n      },\r\n      error: (err) => {\r\n        console.error('Erro ao atualizar status:', err);\r\n        // Usamos um 'alert' simples por enquanto\r\n        alert(`Não foi possível atualizar o Pedido #${pedido.id}. Tente novamente.`);\r\n        pedido.isLoading = false; // Reabilita o botão em caso de erro\r\n      }\r\n    });\r\n  }\r\n\r\n  // (Removi a função getItensPreview, pois o HTML que criei\r\n  // faz um *ngFor nos itens, o que é mais detalhado.)\r\n}"],"mappings":";AAAA,SAASA,SAAS,QAAgB,eAAe;AACjD,SAASC,YAAY,QAAQ,iBAAiB;AAE9C;AACA,SAASC,oBAAoB,QAAQ,wCAAwC;AAetE,IAAMC,sBAAsB,GAA5B,MAAMA,sBAAsB;EAMbC,aAAA;EAJbC,gBAAgB,GAAqB,EAAE;EACvCC,SAAS,GAAG,KAAK;EACjBC,KAAK,GAAkB,IAAI;EAElCC,YAAoBJ,aAA4B;IAA5B,KAAAA,aAAa,GAAbA,aAAa;EAAmB;EAEpDK,QAAQA,CAAA;IACN,IAAI,CAACC,eAAe,EAAE;EACxB;EAEAA,eAAeA,CAAA;IACb,IAAI,CAACJ,SAAS,GAAG,IAAI;IACrB,IAAI,CAACC,KAAK,GAAG,IAAI;IAEjB;IACA,IAAI,CAACH,aAAa,CAACO,eAAe,EAAE,CAACC,SAAS,CAAC;MAC7CC,IAAI,EAAGC,IAAI,IAAI;QACb;QACA,IAAI,CAACT,gBAAgB,GAAGS,IAAI,CACzBC,MAAM,CAACC,MAAM,IAAIA,MAAM,CAACC,MAAM,KAAK,YAAY,CAAC,CAChDC,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAMD,CAAC,CAACE,EAAG,GAAGD,CAAC,CAACC,EAAG,GAAG,CAAC,CAAC,GAAG,CAAE,CAAC,CAAC,CAAC;QAE7C,IAAI,CAACf,SAAS,GAAG,KAAK;MACxB,CAAC;MACDC,KAAK,EAAGe,GAAG,IAAI;QACbC,OAAO,CAAChB,KAAK,CAAC,oCAAoC,EAAEe,GAAG,CAAC;QACxD,IAAI,CAACf,KAAK,GAAG,uCAAuC;QACpD,IAAI,CAACD,SAAS,GAAG,KAAK;MACxB;KACD,CAAC;EACJ;EAEA;;;EAGAkB,gBAAgBA,CAACR,MAAsB;IACrC,IAAI,CAACA,MAAM,CAACK,EAAE,EAAE;IAEhB;IACA;IACAL,MAAM,CAACV,SAAS,GAAG,IAAI;IAEvB;IACA,IAAI,CAACF,aAAa,CAACqB,kBAAkB,CAACT,MAAM,CAACK,EAAE,EAAE,QAAQ,CAAC,CAACT,SAAS,CAAC;MACnEC,IAAI,EAAGa,gBAAgB,IAAI;QACzB;QACA;QACA,IAAI,CAACrB,gBAAgB,GAAG,IAAI,CAACA,gBAAgB,CAACU,MAAM,CAACY,CAAC,IAAIA,CAAC,CAACN,EAAE,KAAKL,MAAM,CAACK,EAAE,CAAC;MAC/E,CAAC;MACDd,KAAK,EAAGe,GAAG,IAAI;QACbC,OAAO,CAAChB,KAAK,CAAC,2BAA2B,EAAEe,GAAG,CAAC;QAC/C;QACAM,KAAK,CAAC,wCAAwCZ,MAAM,CAACK,EAAE,oBAAoB,CAAC;QAC5EL,MAAM,CAACV,SAAS,GAAG,KAAK,CAAC,CAAC;MAC5B;KACD,CAAC;EACJ;CAID;AA9DYH,sBAAsB,GAAA0B,UAAA,EAVlC7B,SAAS,CAAC;EACT8B,QAAQ,EAAE,oBAAoB;EAAE;EAChCC,UAAU,EAAE,IAAI;EAChBC,OAAO,EAAE,CACP/B,YAAY,EACZC,oBAAoB,CAAC;EAAA,CACtB;EACD+B,WAAW,EAAE,iCAAiC;EAC9CC,SAAS,EAAE,CAAC,gCAAgC;CAC7C,CAAC,C,EACW/B,sBAAsB,CA8DlC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}