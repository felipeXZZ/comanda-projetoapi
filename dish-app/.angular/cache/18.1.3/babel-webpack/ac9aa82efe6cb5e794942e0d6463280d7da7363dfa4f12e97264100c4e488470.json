{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n// Importa a Topbar do Admin (como definido no seu TS)\nimport { TopbarComponent } from '../topbarAdmin/topbarAdmin.component';\nlet KitchenOrdersComponent = class KitchenOrdersComponent {\n  pedidoService;\n  pedidosDaCozinha = [];\n  isLoading = false;\n  error = null;\n  constructor(pedidoService) {\n    this.pedidoService = pedidoService;\n  }\n  ngOnInit() {\n    this.carregarPedidos();\n  }\n  carregarPedidos() {\n    this.isLoading = true;\n    this.error = null;\n    this.pedidoService.getAllPedidos().subscribe({\n      next: data => {\n        // --- AJUSTE PRINCIPAL ---\n        // Agora filtra também por 'PENDENTE' (ou qualquer status inicial)\n        this.pedidosDaCozinha = data.filter(pedido => pedido.status === 'PENDENTE' ||\n        // <--- ADICIONADO\n        pedido.status === 'EM_PREPARO' || pedido.status === 'PRONTO').sort((a, b) => a.id < b.id ? -1 : 1); // Ordena por ID\n        this.isLoading = false;\n      },\n      error: err => {\n        console.error('Erro ao buscar pedidos da cozinha:', err);\n        this.error = 'Não foi possível carregar os pedidos.';\n        this.isLoading = false;\n      }\n    });\n  }\n  /**\n   * Chamado quando o botão \"Aceitar Pedido\" é clicado.\n   */\n  aceitarPedido(pedido) {\n    if (!pedido.id) return;\n    pedido.isLoading = true;\n    // Muda o status de PENDENTE para EM_PREPARO\n    this.pedidoService.updatePedidoStatus(pedido.id, 'EM_PREPARO').subscribe({\n      next: pedidoAtualizado => {\n        pedido.status = 'EM_PREPARO'; // Atualiza o status localmente\n        pedido.isLoading = false;\n      },\n      error: err => {\n        console.error('Erro ao aceitar pedido:', err);\n        alert(`Não foi possível aceitar o Pedido #${pedido.id}. Tente novamente.`);\n        pedido.isLoading = false;\n      }\n    });\n  }\n  /**\n   * Chamado quando o botão \"Marcar como Pronto\" é clicado.\n   */\n  marcarComoPronto(pedido) {\n    if (!pedido.id) return;\n    pedido.isLoading = true;\n    this.pedidoService.updatePedidoStatus(pedido.id, 'PRONTO').subscribe({\n      next: pedidoAtualizado => {\n        pedido.status = 'PRONTO';\n        pedido.isLoading = false;\n      },\n      error: err => {\n        console.error('Erro ao atualizar status:', err);\n        alert(`Não foi possível atualizar o Pedido #${pedido.id}. Tente novamente.`);\n        pedido.isLoading = false;\n      }\n    });\n  }\n  /**\n   * (PRÓXIMO PASSO) Chamado quando o botão \"Enviar para Entrega\" é clicado.\n   */\n  enviarParaEntrega(pedido) {\n    if (!pedido.id) return;\n    pedido.isLoading = true; // Usa o mesmo 'isLoading'\n    this.pedidoService.updatePedidoStatus(pedido.id, 'SAIU_PARA_ENTREGA').subscribe({\n      next: pedidoAtualizado => {\n        // Agora sim, removemos da lista da Cozinha/Prontos\n        this.pedidosDaCozinha = this.pedidosDaCozinha.filter(p => p.id !== pedido.id);\n      },\n      error: err => {\n        alert(`Não foi possível enviar o Pedido #${pedido.id} para entrega.`);\n        pedido.isLoading = false;\n      }\n    });\n  }\n};\nKitchenOrdersComponent = __decorate([Component({\n  selector: 'app-kitchen-orders',\n  // seletor no plural\n  standalone: true,\n  imports: [CommonModule, TopbarComponent],\n  templateUrl: './kitchen-orders.component.html',\n  styleUrls: ['./kitchen-orders.component.css']\n})], KitchenOrdersComponent);\nexport { KitchenOrdersComponent };","map":{"version":3,"names":["Component","CommonModule","TopbarComponent","KitchenOrdersComponent","pedidoService","pedidosDaCozinha","isLoading","error","constructor","ngOnInit","carregarPedidos","getAllPedidos","subscribe","next","data","filter","pedido","status","sort","a","b","id","err","console","aceitarPedido","updatePedidoStatus","pedidoAtualizado","alert","marcarComoPronto","enviarParaEntrega","p","__decorate","selector","standalone","imports","templateUrl","styleUrls"],"sources":["C:\\Users\\jvgam\\OneDrive\\Área de Trabalho\\ComandaProjeto\\dish-app\\dish-app\\src\\app\\components\\admin-area\\kitchen-orders\\kitchen-orders.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\n// Importa a Topbar do Admin (como definido no seu TS)\r\nimport { TopbarComponent } from '../topbarAdmin/topbarAdmin.component';\r\n\r\n// Importa o serviço e as interfaces corretas\r\nimport { PedidoService, PedidoCompleto, ItemPedidoCompleto } from '../../../services/pedido.service'; \r\n\r\n@Component({\r\n  selector: 'app-kitchen-orders', // seletor no plural\r\n  standalone: true,\r\n  imports: [\r\n    CommonModule,\r\n    TopbarComponent \r\n  ],\r\n  templateUrl: './kitchen-orders.component.html',\r\n  styleUrls: ['./kitchen-orders.component.css']\r\n})\r\nexport class KitchenOrdersComponent implements OnInit { \r\n\r\n  public pedidosDaCozinha: PedidoCompleto[] = [];\r\n  public isLoading = false;\r\n  public error: string | null = null;\r\n\r\n  constructor(private pedidoService: PedidoService) { }\r\n\r\n  ngOnInit(): void {\r\n    this.carregarPedidos();\r\n  }\r\n\r\n  carregarPedidos(): void {\r\n    this.isLoading = true;\r\n    this.error = null;\r\n\r\n    this.pedidoService.getAllPedidos().subscribe({\r\n      next: (data) => {\r\n        // --- AJUSTE PRINCIPAL ---\r\n        // Agora filtra também por 'PENDENTE' (ou qualquer status inicial)\r\n        this.pedidosDaCozinha = data\r\n          .filter(pedido => \r\n            pedido.status === 'PENDENTE' ||  // <--- ADICIONADO\r\n            pedido.status === 'EM_PREPARO' || \r\n            pedido.status === 'PRONTO'\r\n          )\r\n          .sort((a, b) => (a.id! < b.id! ? -1 : 1)); // Ordena por ID\r\n        \r\n        this.isLoading = false;\r\n      },\r\n      error: (err) => {\r\n        console.error('Erro ao buscar pedidos da cozinha:', err);\r\n        this.error = 'Não foi possível carregar os pedidos.';\r\n        this.isLoading = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Chamado quando o botão \"Aceitar Pedido\" é clicado.\r\n   */\r\n  aceitarPedido(pedido: PedidoCompleto): void {\r\n    if (!pedido.id) return;\r\n    pedido.isLoading = true; \r\n\r\n    // Muda o status de PENDENTE para EM_PREPARO\r\n    this.pedidoService.updatePedidoStatus(pedido.id, 'EM_PREPARO').subscribe({\r\n      next: (pedidoAtualizado) => {\r\n        pedido.status = 'EM_PREPARO'; // Atualiza o status localmente\r\n        pedido.isLoading = false;\r\n      },\r\n      error: (err) => {\r\n        console.error('Erro ao aceitar pedido:', err);\r\n        alert(`Não foi possível aceitar o Pedido #${pedido.id}. Tente novamente.`);\r\n        pedido.isLoading = false; \r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Chamado quando o botão \"Marcar como Pronto\" é clicado.\r\n   */\r\n  marcarComoPronto(pedido: PedidoCompleto): void {\r\n    if (!pedido.id) return;\r\n    pedido.isLoading = true; \r\n\r\n    this.pedidoService.updatePedidoStatus(pedido.id, 'PRONTO').subscribe({\r\n      next: (pedidoAtualizado) => {\r\n        pedido.status = 'PRONTO';\r\n        pedido.isLoading = false;\r\n      },\r\n      error: (err) => {\r\n        console.error('Erro ao atualizar status:', err);\r\n        alert(`Não foi possível atualizar o Pedido #${pedido.id}. Tente novamente.`);\r\n        pedido.isLoading = false; \r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * (PRÓXIMO PASSO) Chamado quando o botão \"Enviar para Entrega\" é clicado.\r\n   */\r\n  enviarParaEntrega(pedido: PedidoCompleto): void {\r\n    if (!pedido.id) return;\r\n    pedido.isLoading = true; // Usa o mesmo 'isLoading'\r\n\r\n    this.pedidoService.updatePedidoStatus(pedido.id, 'SAIU_PARA_ENTREGA').subscribe({\r\n       next: (pedidoAtualizado) => {\r\n         // Agora sim, removemos da lista da Cozinha/Prontos\r\n         this.pedidosDaCozinha = this.pedidosDaCozinha.filter(p => p.id !== pedido.id);\r\n       },\r\n       error: (err) => {\r\n         alert(`Não foi possível enviar o Pedido #${pedido.id} para entrega.`);\r\n         pedido.isLoading = false;\r\n       }\r\n    });\r\n  }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}