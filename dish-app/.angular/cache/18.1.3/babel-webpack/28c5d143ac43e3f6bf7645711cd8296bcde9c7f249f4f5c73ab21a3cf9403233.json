{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nexport let CartService = /*#__PURE__*/(() => {\n  class CartService {\n    // BehaviorSubject é um \"Observable\" especial que guarda o valor atual\n    // Ele vai guardar a nossa lista de itens do carrinho. Começa vazio.\n    itemsSubject = new BehaviorSubject([]);\n    // Qualquer componente pode \"ouvir\" o items$ para ver as mudanças no carrinho em tempo real\n    items$ = this.itemsSubject.asObservable();\n    // Um Observable que calcula o total automaticamente sempre que o carrinho muda\n    total$ = this.items$.pipe(map(items => {\n      return items.reduce((total, item) => total + item.dish.price * item.quantidade, 0);\n    }));\n    constructor() {}\n    /**\n     * Adiciona um prato (Dish) ao carrinho.\n     * Se o item já existir, apenas incrementa a quantidade.\n     */\n    addItem(dish, quantity = 1) {\n      const currentItems = this.itemsSubject.getValue();\n      const existingItem = currentItems.find(item => item.dish.id === dish.id);\n      if (existingItem) {\n        // Item já existe, só incrementa a quantidade\n        existingItem.quantidade += quantity;\n      } else {\n        // Item novo, adiciona com quantidade 1\n        currentItems.push({\n          dish: dish,\n          quantidade: quantity\n        });\n      }\n      // Emite o novo valor do carrinho para todos os \"ouvintes\"\n      this.itemsSubject.next([...currentItems]);\n      console.log('Carrinho atual:', currentItems);\n    }\n    /***\n     * Diminui a quantidade de um item no carrinho.\n     * Se a quantidade chegar a zero, remove o item.\n     */\n    decreaseQuantity(dishId) {\n      const currentItems = this.itemsSubject.getValue();\n      const existingItem = currentItems.find(item => item.dish.id === dishId);\n      if (existingItem && existingItem.quantidade > 1) {\n        // Se tem mais de 1, apenas diminui a quantidade\n        existingItem.quantidade--;\n        // Emite a lista atualizada (com nova referência)\n        this.itemsSubject.next([...currentItems]);\n      }\n    }\n    /**\n     * Remove um item do carrinho (pelo ID do prato).\n     */\n    removeItem(dishId) {\n      const currentItems = this.itemsSubject.getValue();\n      const updatedItems = currentItems.filter(item => item.dish.id !== dishId);\n      this.itemsSubject.next(updatedItems);\n    }\n    /**\n     * Limpa o carrinho (usado após o pedido ser finalizado).\n     */\n    clearCart() {\n      this.itemsSubject.next([]);\n    }\n    /**\n     * Pega o valor atual dos itens (para enviar ao backend).\n     */\n    getCurrentItems() {\n      return this.itemsSubject.getValue();\n    }\n    static ɵfac = function CartService_Factory(ɵt) {\n      return new (ɵt || CartService)();\n    };\n    static ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: CartService,\n      factory: CartService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n  return CartService;\n})();","map":{"version":3,"names":["BehaviorSubject","map","CartService","itemsSubject","items$","asObservable","total$","pipe","items","reduce","total","item","dish","price","quantidade","constructor","addItem","quantity","currentItems","getValue","existingItem","find","id","push","next","console","log","decreaseQuantity","dishId","removeItem","updatedItems","filter","clearCart","getCurrentItems","factory","ɵfac","providedIn"],"sources":["C:\\Users\\jvgam\\OneDrive\\Área de Trabalho\\ComandaProjeto\\dish-app\\dish-app\\src\\app\\services\\cart.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { Dish } from './dish.service'; // Importa a interface 'Dish' que já temos\r\n\r\n// Interface para um item *dentro* do carrinho\r\nexport interface CartItem {\r\n  dish: Dish;\r\n  quantidade: number;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class CartService {\r\n\r\n  // BehaviorSubject é um \"Observable\" especial que guarda o valor atual\r\n  // Ele vai guardar a nossa lista de itens do carrinho. Começa vazio.\r\n  private itemsSubject = new BehaviorSubject<CartItem[]>([]);\r\n\r\n  // Qualquer componente pode \"ouvir\" o items$ para ver as mudanças no carrinho em tempo real\r\n  public items$: Observable<CartItem[]> = this.itemsSubject.asObservable();\r\n\r\n  // Um Observable que calcula o total automaticamente sempre que o carrinho muda\r\n  public total$: Observable<number> = this.items$.pipe(\r\n    map(items => {\r\n      return items.reduce((total, item) => total + (item.dish.price * item.quantidade), 0);\r\n    })\r\n  );\r\n\r\n  constructor() { }\r\n\r\n  /**\r\n   * Adiciona um prato (Dish) ao carrinho.\r\n   * Se o item já existir, apenas incrementa a quantidade.\r\n   */\r\n  public addItem(dish: Dish, quantity: number = 1): void {\r\n    const currentItems = this.itemsSubject.getValue();\r\n    const existingItem = currentItems.find(item => item.dish.id === dish.id);\r\n\r\n    if (existingItem) {\r\n      // Item já existe, só incrementa a quantidade\r\n      existingItem.quantidade += quantity;\r\n    } else {\r\n      // Item novo, adiciona com quantidade 1\r\n      currentItems.push({ dish: dish, quantidade: quantity });\r\n    }\r\n\r\n    // Emite o novo valor do carrinho para todos os \"ouvintes\"\r\n    this.itemsSubject.next([...currentItems]);\r\n    console.log('Carrinho atual:', currentItems);\r\n  }\r\n\r\n\r\n  /***\r\n   * Diminui a quantidade de um item no carrinho.\r\n   * Se a quantidade chegar a zero, remove o item.\r\n   */\r\n\r\n  public decreaseQuantity(dishId: number): void {\r\n    const currentItems = this.itemsSubject.getValue();\r\n    const existingItem = currentItems.find(item => item.dish.id === dishId);\r\n\r\n    if (existingItem && existingItem.quantidade > 1) {\r\n      // Se tem mais de 1, apenas diminui a quantidade\r\n      existingItem.quantidade--;\r\n      // Emite a lista atualizada (com nova referência)\r\n      this.itemsSubject.next([...currentItems]);\r\n    } \r\n  }\r\n\r\n  /**\r\n   * Remove um item do carrinho (pelo ID do prato).\r\n   */\r\n  public removeItem(dishId: number): void {\r\n    const currentItems = this.itemsSubject.getValue();\r\n    const updatedItems = currentItems.filter(item => item.dish.id !== dishId);\r\n\r\n    this.itemsSubject.next(updatedItems);\r\n  }\r\n\r\n  /**\r\n   * Limpa o carrinho (usado após o pedido ser finalizado).\r\n   */\r\n  public clearCart(): void {\r\n    this.itemsSubject.next([]);\r\n  }\r\n\r\n  /**\r\n   * Pega o valor atual dos itens (para enviar ao backend).\r\n   */\r\n  public getCurrentItems(): CartItem[] {\r\n    return this.itemsSubject.getValue();\r\n  }\r\n}\r\n"],"mappings":"AACA,SAASA,eAAe,QAAoB,MAAM;AAClD,SAASC,GAAG,QAAQ,gBAAgB;;AAYpC,WAAaC,WAAW;EAAlB,MAAOA,WAAW;IAEtB;IACA;IACQC,YAAY,GAAG,IAAIH,eAAe,CAAa,EAAE,CAAC;IAE1D;IACOI,MAAM,GAA2B,IAAI,CAACD,YAAY,CAACE,YAAY,EAAE;IAExE;IACOC,MAAM,GAAuB,IAAI,CAACF,MAAM,CAACG,IAAI,CAClDN,GAAG,CAACO,KAAK,IAAG;MACV,OAAOA,KAAK,CAACC,MAAM,CAAC,CAACC,KAAK,EAAEC,IAAI,KAAKD,KAAK,GAAIC,IAAI,CAACC,IAAI,CAACC,KAAK,GAAGF,IAAI,CAACG,UAAW,EAAE,CAAC,CAAC;IACtF,CAAC,CAAC,CACH;IAEDC,YAAA,GAAgB;IAEhB;;;;IAIOC,OAAOA,CAACJ,IAAU,EAAEK,QAAA,GAAmB,CAAC;MAC7C,MAAMC,YAAY,GAAG,IAAI,CAACf,YAAY,CAACgB,QAAQ,EAAE;MACjD,MAAMC,YAAY,GAAGF,YAAY,CAACG,IAAI,CAACV,IAAI,IAAIA,IAAI,CAACC,IAAI,CAACU,EAAE,KAAKV,IAAI,CAACU,EAAE,CAAC;MAExE,IAAIF,YAAY,EAAE;QAChB;QACAA,YAAY,CAACN,UAAU,IAAIG,QAAQ;MACrC,CAAC,MAAM;QACL;QACAC,YAAY,CAACK,IAAI,CAAC;UAAEX,IAAI,EAAEA,IAAI;UAAEE,UAAU,EAAEG;QAAQ,CAAE,CAAC;MACzD;MAEA;MACA,IAAI,CAACd,YAAY,CAACqB,IAAI,CAAC,CAAC,GAAGN,YAAY,CAAC,CAAC;MACzCO,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAER,YAAY,CAAC;IAC9C;IAGA;;;;IAKOS,gBAAgBA,CAACC,MAAc;MACpC,MAAMV,YAAY,GAAG,IAAI,CAACf,YAAY,CAACgB,QAAQ,EAAE;MACjD,MAAMC,YAAY,GAAGF,YAAY,CAACG,IAAI,CAACV,IAAI,IAAIA,IAAI,CAACC,IAAI,CAACU,EAAE,KAAKM,MAAM,CAAC;MAEvE,IAAIR,YAAY,IAAIA,YAAY,CAACN,UAAU,GAAG,CAAC,EAAE;QAC/C;QACAM,YAAY,CAACN,UAAU,EAAE;QACzB;QACA,IAAI,CAACX,YAAY,CAACqB,IAAI,CAAC,CAAC,GAAGN,YAAY,CAAC,CAAC;MAC3C;IACF;IAEA;;;IAGOW,UAAUA,CAACD,MAAc;MAC9B,MAAMV,YAAY,GAAG,IAAI,CAACf,YAAY,CAACgB,QAAQ,EAAE;MACjD,MAAMW,YAAY,GAAGZ,YAAY,CAACa,MAAM,CAACpB,IAAI,IAAIA,IAAI,CAACC,IAAI,CAACU,EAAE,KAAKM,MAAM,CAAC;MAEzE,IAAI,CAACzB,YAAY,CAACqB,IAAI,CAACM,YAAY,CAAC;IACtC;IAEA;;;IAGOE,SAASA,CAAA;MACd,IAAI,CAAC7B,YAAY,CAACqB,IAAI,CAAC,EAAE,CAAC;IAC5B;IAEA;;;IAGOS,eAAeA,CAAA;MACpB,OAAO,IAAI,CAAC9B,YAAY,CAACgB,QAAQ,EAAE;IACrC;;wBA/EWjB,WAAW;IAAA;;aAAXA,WAAW;MAAAgC,OAAA,EAAXhC,WAAW,CAAAiC,IAAA;MAAAC,UAAA,EAFV;IAAM;;SAEPlC,WAAW;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}